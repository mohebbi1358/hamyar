
{% extends "base.html" %}
{% load jalali_filters %}


{% block title %}Ø¬Ø²Ø¦ÛŒØ§Øª Ø´Ù‡ÛŒØ¯{% endblock %}

{% block content %}
{% if user.is_authenticated and user.is_superuser %}
  <div class="text-center mb-4">
    <a href="{% url 'martyrs:martyr_edit' martyr.id %}" class="btn btn-warning">
      <i class="bi bi-pencil-square"></i> ÙˆÛŒØ±Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù‡ÛŒØ¯
    </a>
  </div>
{% endif %}

<div style="max-width: 800px; margin: auto; padding: 20px;">
  
  <!-- ğŸ”¹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù‡ÛŒØ¯ -->
  <div style="text-align: center; margin-bottom: 30px;">
    <h2 style="margin-bottom: 10px;">{{ martyr.first_name }} {{ martyr.last_name }}</h2>

    {% if martyr.photo %}
      <img src="{{ martyr.photo.url }}" alt="{{ martyr }}" style="max-width: 200px; border-radius: 8px; border: 1px solid #ccc;">
    {% endif %}
  </div>

  <ul style="list-style: none; padding: 0; font-size: 16px; line-height: 1.8;">
    <li><strong>Ù†Ø§Ù… Ù¾Ø¯Ø±:</strong> {{ martyr.father_name }}</li>
    <li><strong>Ù…Ø­Ù„ ØªÙˆÙ„Ø¯:</strong> {{ martyr.birth_place }}</li>
    
    <li><strong>ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯:</strong> {{ martyr.birth_date|to_jalali }}</li>
    <li><strong>Ø¹Ù…Ù„ÛŒØ§Øª Ø¢Ø®Ø±:</strong> {{ martyr.last_operation }}</li>
    <li><strong>Ù…Ù†Ø·Ù‚Ù‡ Ø´Ù‡Ø§Ø¯Øª:</strong> {{ martyr.martyr_region }}</li>
    <li><strong>Ù…Ø­Ù„ Ø´Ù‡Ø§Ø¯Øª:</strong> {{ martyr.martyr_place }}</li>
    <li><strong>ØªØ§Ø±ÛŒØ® Ø´Ù‡Ø§Ø¯Øª:</strong> {{ martyr.martyr_date|to_jalali }}</li>
    <li><strong>Ù…Ø­Ù„ Ø¯ÙÙ†:</strong> {{ martyr.grave_place }}</li>
  </ul>

  <hr style="margin: 30px 0;">

  <!-- ğŸ”¹ ÙØ±Ù… Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡ -->
  {% if user.is_authenticated %}
    <h3>Ø«Ø¨Øª Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡</h3>
    <form method="post" enctype="multipart/form-data" style="margin-bottom: 30px;">
      {% csrf_token %}

      <label for="id_persona">Ø´Ø®ØµÛŒØª:</label>
      {{ form.persona }}

      <label for="id_text">Ù…ØªÙ† Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡:</label>
      {{ form.text }}

      <label for="id_image">ØªØµÙˆÛŒØ±:</label>
      {{ form.image }}

      <label for="id_audio">ÙØ§ÛŒÙ„ ØµÙˆØªÛŒ:</label>
      {{ form.audio }}

      <button type="submit" style="padding: 8px 16px; background-color: #0055aa; color: white; border: none; border-radius: 4px; cursor: pointer;">
        Ø§Ø±Ø³Ø§Ù„
      </button>
    </form>
  {% else %}
    <p style="text-align: center; margin-bottom: 30px;">
      Ø¨Ø±Ø§ÛŒ Ø«Ø¨Øª Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡ <a href="{% url 'account:login' %}?next={{ request.path }}" style="color: #0055aa;">ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯</a>.
    </p>
  {% endif %}

  <hr>

  <!-- ğŸ”¹ Ù„ÛŒØ³Øª Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡â€ŒÙ‡Ø§ -->
  <h3 style="margin-top: 30px;">Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡â€ŒÙ‡Ø§</h3>
  {% if memories %}
    {% for memory in memories %}
      <div style="border: 1px solid #ddd; border-radius: 6px; padding: 15px; margin-bottom: 20px; background-color: #f9f9f9;">
        
 <!--       <p style="margin-bottom: 10px;">
          <strong>Ú©Ø§Ø±Ø¨Ø±:</strong>
          {% if memory.user.first_name or memory.user.last_name %}
            {{ memory.user.first_name }} {{ memory.user.last_name }}
          {% else %}
            -
          {% endif %}

        </p>
        -->

        <p style="margin-bottom: 10px;">
          <strong>Ø´Ø®ØµÛŒØª:</strong> {{ memory.persona.name }}
        </p>

        {% if memory.text %}
          <p style="margin-bottom: 10px;">{{ memory.text }}</p>
        {% endif %}

        {% if memory.image %}
          <div style="margin-bottom: 10px;">
            <img src="{{ memory.image.url }}" alt="" style="max-width: 100%; border-radius: 6px;">
          </div>
        {% endif %}

        {% if memory.audio %}
          <div style="margin-bottom: 10px;">
            <audio controls style="width: 100%;">
              <source src="{{ memory.audio.url }}" type="audio/mpeg">
              Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ù¾Ø®Ø´ ØµÙˆØª Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
            </audio>
          </div>
        {% endif %}

        <p style="font-size: 0.85em; color: gray;">{{ memory.created_at|to_jalali }}</p>
      </div>
    {% endfor %}
  {% else %}
    <p style="text-align: center;">Ù‡ÛŒÚ† Ø¯Ù„â€ŒÙ†ÙˆØ´ØªÙ‡â€ŒØ§ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
  {% endif %}

</div>
{% endblock %}
